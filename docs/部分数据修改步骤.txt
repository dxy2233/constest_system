#清除推荐关系步骤
#1/查出推荐关系送出的对应gdt及投票券数量
#2/删除gr_user_currency_detail及gr_voucher表中对应赠送数据
#3/删除gr_voucher_detail表中投票券使用记录
#4/删除gr_user_recommend表中推荐记录
#5/修改gr_user表中所有相关推荐关系用户的parent_list字段内容
#6/重算gr_user_currency表与gr_user_voucher表

#转让节点步骤
#准备工作/检查新手机号用户是否存在，select * from gr_user where mobile = {$new_mobile},检查新用户身份证号是否已使用,select * from gr_user_identify where number = {$number} && status = 1,当两个数据都未使用时，可执行后续操作
#1/查询出对应的user_id, select id from gr_user where mobile = {$old_mobile}
#2/清除原实名认证信息,update gr_user_identify set status = 2,status_remark = '节点转让' where user_id = {$user_id} && status = 1
#3/添加新实名认证信息,INSERT INTO `gr_user_identify` (`user_id`, `realname`, `type`, `number`, `pic_front`, `pic_back`, `status`, `status_remark`, `remark`, `audit_admin_id`, `examine_time`, `create_time`, `update_time`) VALUES
({$user_id},	'{$name}',	1,	'{$number}',	'{$image}',	'{$image}',	1,	'已通过',	'',	1,	0,	0,	0)
#4/修改用户表绑定手机号update gr_user set mobile = {$new_mobile} where id = {$user_id}


#取消节点步骤
#gr_history
#修改gr_node表对应数据为未审核
#清除gr_user_currency_detail所有数据，包括成功节点送gdt，推荐向上级送gdt，推荐其它用户送gdt，成为节点时的grt,tt,bpt数据模拟
#清除gr_user_currency_frozen中成为节点时模拟冻结的资产
#清除gr_user_recharge_withdraw中成为节点时模拟转入的资产
#修改gr_user_recommend中被推荐人是此用户的记录中node_id及amount
#重算gr_user_currency表中所有币种数量


#**判断gr_vote中是否存在对此节点进行的投票，若有、清除所有投票并退回投票花费的grt,投票券，追回投票奖励gdt，然后执行下一步
#**清除gr_voucher_detail中所有使用投票券向此节点投票的记录及此节点的所有投票券使用记录


#清除gr_voucher此用户推荐获得的所有投票券记录
#重算gr_user_voucher表中投票券数量

#节点转让步骤 实际案例

# 撤销 14717886999 的超级节点
1、查询 gr_user mobile = 14717886999 是否存在获得 ${user_id}
2、查询 gr_node user_id = ${user_id} 获取 ${node_id}
3、查看 gr_vote node_id = ${node_id} 获取 ${vote_id} $(sum(vote_number) as vote_number) // 被投票数
# 投票方式 支付投票/投票奖励GDT
4、查看 gr_user_currency_datail relate_table = vote and relate_id = ${vote_id}
4、查看 gr_user_currency_frozen relate_table = vote and relate_id = ${vote_id}

删除实名认证，保留删除数据，下面备用 ${identify_data}
其他数据不进行剔除的情况下  获取 gr_vote 查询的 所有投票记录 （node_id 需要投票转让的时候需替换转让节点ID）

#节点用户 13501580622 转让 给 14717886999 用户

1、查找 gr_user mobile = 13501580622 获取用户 ID ${id}
2、查询 gr_node user_id = ${id} 获取 ${node_id}
2、将 gr_user id = ${id} 更改手机号为 14717886999
3、将 gr_user_identify 中 user_id = ${id} 的实名认证记录更换成上个撤销账户的实名认证 ${identify_data}
4、将 gr_vote 中更改撤销账户的 node_id =  ${node_id}




#曾嫦娥转张红丽事件处理方式意见

#第一部分 撤消张红丽超级节点

#清除gr_user_currency_detail所有数据，包括成功节点送gdt，推荐向上级送gdt，推荐其它用户送gdt，成为节点时的grt,tt,bpt数据模拟
#清除gr_voucher,gr_user_voucher,gr_voucher_detail中张红丽获得的投票券，并清除gr_vote中张红丽使用这部分投票券的投票记录
#清除gr_user_currency_frozen中成为节点时模拟冻结的资产
#清除gr_user_recharge_withdraw中成为节点时模拟转入的资产
#修改gr_user_recommend中被推荐人是此用户的记录中node_id及amount
#重算gr_user_currency表中所有币种数量


#第二部分 将曾嫦娥节点转让给张红丽

#修改gr_node表中曾嫦娥的节点user_id为张红丽的user_id,
#将gr_vote中所有指向原张红丽的节点的投票的node_id变更为上一步所转让的节点ID
#将gr_user_currency_detail，gr_user_currency_frozen及gr_user_recharge_withdraw表中曾嫦娥因申请节点中的模拟数据更改user_id至张红丽名下，包括申请节点奖励的gdt
#删除gr_node表中原张红丽超级节点对应数据
#清除所有关于曾嫦娥的相关数据，包括gr_user,gr_voucher,gr_user_voucher,gr_voucher_detail,gr_vote,gr_user_currency,gr_user_currency_detail,gr_user_currency_frozen,gr_user_recharge_withdraw, gr_user_recharge_address,gr_user_other,gr_user_recommend,gr_node


#第三部分 补回张红丽及其上级的推荐奖励
